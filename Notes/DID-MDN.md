【论文笔记】使用多流密集网络的密度感知单图像去雨
===================================

## 0 摘要

提出一种密度感知多路稠密连接卷积神经网络算法，DID-MDN。

这种算法可以使网络自动地判断雨密度，然后并根据所得雨量密度估计标签去除雨线。

为了更好的描述雨线的尺寸和形状，一种多路密集连接的去雨网络能够利用不同尺寸雨线的特征。

此外，创建了一个新的带有雨量密度的新数据集，用来训练密度感知网络。

在合成的和真实的数据集上的大量实验证明这种方法达到了有效的提升。另外，进行消融研究以证明在所提出的方法中由不同模块获得的改进。


## 1 介绍
现有单图像去雨方法的局限：

现有方法仅能处理特定类型的雨图，不能有效考虑雨滴的形状，范围和密度 => 导致过度去雨和去雨不足

解决方案：1.扩充数据集 2.密度感知

提出DID-MDN网络，自动的判断雨量密度信息（大、中、小），并将其运用到去雨中。

DID-MDN包括两步：雨密度分类和雨线去除。

（1）为了准确估计雨密度级别，一种新的残差网络利用残差模块在有雨的做分类。
（2）雨线去除算法基于多流密集连接网络，它考虑了雨线的尺寸和形状信息。

一旦雨密度级别估计出来，融合已估计的雨密度信息到多流密集连接网络，得到最终的除雨的输出结果。

此外，为了高效的训练这种网络，合成了一个大规模的数据集，包含12000张图片，有不同雨密度级别。

此论文有如下贡献：

1. DID-MDN 自动的判断雨量密度信息，然后通过估计出来的雨量密度标签去除雨线。
2. 基于残差可以作为更好的描述雨密度信息的特征，论文提出残差感知分类器来判断雨量密度。
3. 合成数据集包括 12000 带有雨量密度的训练图片和1200张测试图片。据作者所知这是第一个包含雨量标签的数据集。尽管是在合成数据上训练的，它可以泛化到真实世界的图片。
4. 在三个高挑战性的数据集上（两个合成、一个真实）和比赛上进行了大量的实验。

## 2 背景和相关工作
### 2.1 单图像去雨理论基础
数学上，一张雨图y可以被认为是雨滴r和背景x的结合，即

<img src="https://latex.codecogs.com/gif.latex?y&space;=&space;x&space;&plus;&space;r" title="y = x + r" />

在单图像去雨中，主要任务是根据雨图y恢复背景x

### 2.2 不同尺度特征聚合


DID-MDN（Density-aware Image De-raining Multi-stream Dense Network）主要分为两个部分：
1. residual-aware classifier,主要用来确定雨量密度信息
2. multi-stram dense network，主要基于多流密集连接网络，考虑雨线的尺寸和形状，结合雨量密度信息进行去雨。
